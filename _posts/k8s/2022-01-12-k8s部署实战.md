---
layout: post
comments: true
categories: k8s
title: "k8séƒ¨ç½²å®æˆ˜"
---

* content
{:toc}

## å‰è¨€

k8så…¨ç§°kubernetesï¼Œè¿™ä¸ªåå­—å¤§å®¶åº”è¯¥éƒ½ä¸é™Œç”Ÿï¼Œk8sæ˜¯ä¸ºå®¹å™¨æœåŠ¡è€Œç”Ÿçš„ä¸€ä¸ªå¯ç§»æ¤å®¹å™¨çš„ç¼–æ’ç®¡ç†å·¥å…·ï¼Œè¶Šæ¥è¶Šå¤šçš„å…¬å¸æ­£åœ¨æ‹¥æŠ±k8sï¼Œå¹¶ä¸”å½“å‰k8så·²ç»ä¸»å¯¼äº†äº‘ä¸šåŠ¡æµç¨‹ï¼Œæ¨åŠ¨äº†å¾®æœåŠ¡æ¶æ„ç­‰çƒ­é—¨æŠ€æœ¯çš„æ™®åŠå’Œè½åœ°ï¼Œæ­£åœ¨å¦‚ç«å¦‚è¼çš„å‘å±•ã€‚

æœ¬æ–‡ä¸»è¦ä»‹ç»k8sçš„éƒ¨ç½²å®æ–½æ–¹æ³•ã€‚

k8sä¸€å…±æœ‰ä¸‰ç§æ–¹å¼éƒ¨ç½²ç›®å‰ä¸€å…±ä¸‰ç§éƒ¨ç½²æ–¹å¼ï¼š

* [Minikube][minikube]ï¼šå®˜æ–¹éƒ¨ç½²å·¥å…·ï¼Œå¯ä»¥åœ¨æœ¬åœ°å¿«é€Ÿè¿è¡Œä¸€ä¸ªå•ç‚¹çš„k8sï¼Œå¯ä»¥ç”¨äºæ—¥å¸¸å¼€å‘å’Œå­¦ä¹ ä½¿ç”¨ã€‚
* [Kubeadm][kubeadm]ï¼šå®˜æ–¹éƒ¨ç½²å·¥å…·ï¼Œç”¨äºå¿«é€Ÿéƒ¨ç½²å’ŒèŠ‚ç‚¹ç®¡ç†ç­‰ï¼Œä½¿ç”¨è¦æ±‚è¾ƒå¤šï¼Œå¯ä»¥ç”¨äºç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ã€‚
* [äºŒè¿›åˆ¶åŒ…](https://github.com/kubernetes/kubernetes/releases)ï¼šå³æ‰‹å·¥éƒ¨ç½²ï¼Œéœ€è¦è‡ªå·±ä¸‹è½½äºŒè¿›åˆ¶åŒ…ï¼Œå¹¶æ‰‹åŠ¨é…ç½®å’Œå¯åŠ¨k8sæœåŠ¡ã€‚

### Minikubeéƒ¨ç½²

å¯¹äºå¼€å‘å’Œå­¦ä¹ ä½¿ç”¨ï¼ŒMinikubeæ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºéƒ¨ç½²éå¸¸ç®€å•ï¼Œå¯ä»¥èŠ‚çœå¤§é‡æ—¶é—´ï¼Œä¸ç”¨é™·å…¥å„ç§é…ç½®ç»†èŠ‚ã€‚

ä½¿ç”¨Minikubeéœ€è¦å…ˆå®‰è£…Minikubeã€‚

[å®˜æ–¹æ–‡æ¡£][minikube]æä¾›äº†å¤šç§å®‰è£…æ–¹å¼ï¼Œåœ¨æœ¬æ–‡æˆ‘ä»¬ä½¿ç”¨64ä½çš„CentOS 7ï¼Œä½¿ç”¨å¦‚ä¸‹æ–¹å¼å®‰è£…ï¼š

```
curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
sudo install minikube-linux-amd64 /usr/local/bin/minikube
```

å®‰è£…å®Œæˆåï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯åŠ¨ï¼š

```
minikube start
```

æ­£ç¡®æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š

```
ğŸ˜„  minikube v1.24.0 on Centos 7.6.1810 (kvm/amd64)
âœ¨  Using the docker driver based on existing profile
ğŸ‘  Starting control plane node minikube in cluster minikube
ğŸšœ  Pulling base image ...
ğŸ”„  Restarting existing docker container for "minikube" ...
ğŸ³  Preparing Kubernetes v1.22.3 on Docker 20.10.8 ...
ğŸ”  Verifying Kubernetes components...
    â–ª Using image gcr.io/k8s-minikube/storage-provisioner:v5
ğŸŒŸ  Enabled addons: storage-provisioner, default-storageclass
ğŸ„  Done! kubectl is now configured to use "minikube" cluster and "default" namespace by default
```

minikubeæ”¯æŒåŸºäºdockerï¼Œkvm2ï¼ŒvirtualBoxï¼Œè£¸é‡‘å±ï¼Œpodmanç­‰å¤šç§ç¯å¢ƒéƒ¨ç½²ï¼Œå› æ­¤startä¹‹å‰ï¼Œå¿…é¡»å·²ç»å®‰è£…å¦‚ä¸Šç¯å¢ƒä¹‹ä¸€ï¼Œå¹¶ä¸”éœ€è¦å®‰è£…sshï¼Œå¦åˆ™å¯èƒ½å®‰è£…å¤±è´¥ã€‚

ç¬”è€…è¿™é‡Œæ˜¯å®‰è£…äº†dockerç¯å¢ƒï¼Œå› æ­¤å¯åŠ¨è¿‡ç¨‹ä½¿ç”¨äº†dockerä½œä¸ºk8sçš„é©±åŠ¨ï¼Œåœ¨å¯åŠ¨æ—¥å¿—çš„ç¬¬äºŒè¡Œå³å¯çœ‹åˆ°ï¼š

```
âœ¨  Using the docker driver based on existing profile
```

å¯åŠ¨å®Œæˆä¹‹åï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„dockerå®¹å™¨ï¼š

```
$> docker ps
CONTAINER ID   IMAGE                                 COMMAND                  CREATED       STATUS       PORTS                                                                                                                                  NAMES
7f2230cc94fb   gcr.io/k8s-minikube/kicbase:v0.0.28   "/usr/local/bin/entrâ€¦"   4 hours ago   Up 2 hours   127.0.0.1:49162->22/tcp, 127.0.0.1:49161->2376/tcp, 127.0.0.1:49160->5000/tcp, 127.0.0.1:49159->8443/tcp, 127.0.0.1:49158->32443/tcp   minikube
```

å¦‚æœä½ çš„æœºå™¨ä¸Šå·²ç»å®‰è£…`kubectl`, minikubeè¿˜ä¼šè‡ªåŠ¨å°†`kubectl`é…ç½®ä¸ºä½¿ç”¨minikubeæœºç¾¤ï¼Œå¯ä»¥çœ‹åˆ°å¯åŠ¨æ—¥å¿—çš„æœ€åä¸€è¡Œï¼š

```
ğŸ„  Done! kubectl is now configured to use "minikube" cluster and "default" namespace by default
```

å¦‚æœæ²¡æœ‰å®‰è£…`kubectl`çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨`minikube kubectl --`ä»£æ›¿kubectlï¼Œminikubeä¼šè‡ªåŠ¨ä¸‹è½½åˆé€‚çš„kubectlç‰ˆæœ¬è¿›è¡Œæ“ä½œï¼Œä½†æ˜¯æ¯æ¬¡ä½¿ç”¨kubectlå‘½ä»¤éƒ½è¦è¾“å…¥è¿™ä¸ªå‘½ä»¤ä¹Ÿæ¯”è¾ƒéº»çƒ¦ï¼Œå¯ä»¥ä¸ºè¿™ä¸ªå‘½ä»¤è®¾ç½®åˆ«åï¼š

```
alias kubectl="minikube kubectl --"
```

åˆ°è¿™é‡Œæœ¬åœ°ä¸€ä¸ªæœ¬åœ°å¼€å‘çš„k8sé›†ç¾¤å°±éƒ¨ç½²å¥½äº†ï¼Œéå¸¸ç®€å•ã€‚

### Kubeadméƒ¨ç½²

### äºŒè¿›åˆ¶åŒ…éƒ¨ç½²

## å‚è€ƒèµ„æ–™

\[1\]: [ä½¿ç”¨kubeadmå¿«é€Ÿéƒ¨ç½²ä¸€å¥—K8Sé›†ç¾¤ä»¥åŠä¼—å¤šç¥å‘è®°å½•](https://www.cnblogs.com/wanlige/p/14954621.html)

[minikube]: https://minikube.sigs.k8s.io/docs/start/
[kubeadm]: https://kubernetes.io/docs/reference/setup-tools/kubeadm/kubeadm/